---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

Load functions from the corresponding file:

```{r, warning=FALSE}
library("tidyverse")
source("yet_another_functions_up_to_date_24112018.R")
```

5aza data:

```{r}
inTabs <- "~/Dropbox (Partners HealthCare)/replicates_ASE/data/5aza/pr_20180714_ISEKI_processed_gene_extended2.txt"
replicateNumbers <- c(2,2,2,5,2)
replicateNames <- c("control","DMSO","low","medium","high")
rowsSp <- data.frame(matrix(lapply(1:length(replicateNumbers), function(x){(2*sum(replicateNumbers[1:x-1])+1):(2*sum(replicateNumbers[1:x]))}), nrow=5, byrow=T),stringsAsFactors=FALSE)
colnames(rowsSp) <- "replicateCols"
designMatrix <- cbind(replicateNames, replicateNumbers, rowsSp)
geneCountTab <- GetGatkPipelineTabs(inTabs, replicateNumbers, multiple = F)
head(geneCountTab)
```

Then get row-concatenated table of pairewise delta AI for all the 3 experiments:

```{r, warning=FALSE, message=FALSE}
dfDeltaAIPairwise <- do.call(rbind, lapply(1:length(replicateNumbers), function(x){
      CreateMergedDeltaAIPairwiseDF(geneCountTab, mlns=F, repcolmns=unlist(designMatrix$replicateCols[x]), what=designMatrix$replicateNames[x])
    }))
head(dfDeltaAIPairwise)
```
